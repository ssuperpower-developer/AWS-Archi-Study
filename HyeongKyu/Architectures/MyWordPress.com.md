
## 1. WordPress의 주요 구성 요소 이해하기 🧩

WordPress 사이트를 AWS에 배포할 때 고려해야 할 두 가지 주요 구성 요소가 있다:

1. **데이터베이스 계층**: 사용자 데이터, 블로그 포스트, 페이지 콘텐츠, 설정 등을 저장
2. **파일 시스템**: 이미지, 비디오, 테마, 플러그인 파일 등을 저장

이 두 구성 요소를 어떻게 확장 가능하게 설계할지가 핵심 과제이다

## 2. 데이터베이스 계층: RDS에서 Aurora로의 변경 📊

### 2.1 기본 RDS MySQL 설정

처음에는 표준 Amazon RDS MySQL을 사용할 수 있다:

- 다중 AZ 구성으로 고가용성 확보
- 자동 백업 및 유지 관리 기능 활용
- EC2 인스턴스와 연결하여 WordPress 데이터 저장

### 2.2 Aurora MySQL로 업그레이드

![[스크린샷 2025-05-07 오후 11.31.06.png]]

대규모 확장이 필요하다면 Aurora MySQL로 전환하는 것이 좋다:

**Aurora의 주요 장점**:

- RDS MySQL보다 최대 5배 빠른 성능
- 자동 스토리지 확장 (최대 128TB까지)
- 최대 15개의 읽기 전용 복제본 지원
- 100밀리초 미만의 장애 조치 시간
- 글로벌 데이터베이스 지원 (지역 간 복제)

**비용 대비 효율성** 💰 Aurora는 RDS보다 약 20% 비용이 더 들지만, 그만큼 더 높은 성능과 확장성을 제공한다. 특히 트래픽이 많은 WordPress 사이트의 경우 Aurora의 성능 향상으로 전체적인 비용 효율성이 더 좋을 수 있다.

## 3. 파일 스토리지: EBS vs EFS 비교 💾

WordPress에서는 이미지, 비디오 등의 미디어 파일을 저장해야 한다. 이를 위한 두 가지 주요 옵션을 살펴보자:

### 3.1 EBS(Elastic Block Store) 방식

**단일 인스턴스 구성**:

- 하나의 EC2 인스턴스에 EBS 볼륨 연결
- 모든 미디어 파일이 이 볼륨에 저장
- 간단하고 비용 효율적인 설정

**문제점**:
![[스크린샷 2025-05-07 오후 11.31.57.png]]
- 여러 EC2 인스턴스로 확장 시 각 인스턴스는 자체 EBS 볼륨을 갖게 됨
- 한 인스턴스에 업로드된 이미지는 다른 인스턴스에서 접근 불가능
- 로드 밸런싱 환경에서 사용자 경험 불일치 발생

**예시 시나리오** 🚫:

1. 사용자가 인스턴스 A에 이미지 업로드
2. 이미지는 인스턴스 A의 EBS 볼륨에만 저장됨
3. 다음 요청이 인스턴스 B로 라우팅될 경우
4. 인스턴스 B는 해당 이미지에 접근할 수 없어 "이미지를 찾을 수 없음" 오류 발생

### 3.2 EFS(Elastic File System) 방식

![[스크린샷 2025-05-07 오후 11.32.16.png]]

**다중 인스턴스 공유 스토리지**:

- 모든 AZ에 걸쳐 액세스 가능한 네트워크 파일 시스템(NFS)
- 각 AZ에 ENI(Elastic Network Interface) 생성
- 모든 EC2 인스턴스가 동일한 파일 시스템에 접근 가능

**주요 이점**:

- 모든 인스턴스에서 일관된 파일 액세스
- 자동 확장 스토리지 (페타바이트 규모까지)
- 다중 AZ 고가용성
- EC2 인스턴스 수에 관계없이 일관된 사용자 경험

**작동 방식** ✅:

1. 사용자가 인스턴스 A에 이미지 업로드
2. 이미지는 ENI를 통해 EFS에 저장됨
3. 다음 요청이 인스턴스 B로 라우팅되어도
4. 인스턴스 B는 ENI를 통해 EFS에서 동일한 이미지에 접근 가능

**note** 📝 EFS는 EBS보다 GB당 비용이 더 높지만, 사용한 만큼만 비용을 지불하는 방식이라 작은 사이트에서도 부담 없이 시작할 수 있다. 또한 파일 접근 빈도에 따라 표준 스토리지와 저빈도 접근 스토리지 간에 자동으로 데이터를 이동시키는 라이프사이클 관리 기능도 있다

## 4. 완전한 WordPress 아키텍처 구성 🏗️

이제 모든 요소를 결합하여 확장 가능한 WordPress 아키텍처를 구성해 보자:

### 4.1 기본 구성 요소

1. **Route 53**: 도메인 관리 및 DNS 라우팅
2. **CloudFront**: 글로벌 CDN으로 정적 콘텐츠 전송 가속화 (선택 사항)
3. **ALB/ELB**: 다중 AZ 로드 밸런서로 트래픽 분산
4. **Auto Scaling Group**: 여러 AZ에 걸친 EC2 인스턴스 자동 확장
5. **EFS**: 모든 인스턴스에서 공유하는 미디어 파일 스토리지
6. **Aurora MySQL**: WordPress 데이터베이스 (다중 AZ, 읽기 전용 복제본)
7. **Security Groups**: 계층별 보안 설정

### 4.2 추가 고려 사항

- **ElastiCache**: 페이지 캐싱으로 성능 향상 및 데이터베이스 부하 감소
- **AWS WAF**: 웹 애플리케이션 방화벽으로 보안 강화
- **S3 버킷**: 대용량 미디어 파일 저장 및 백업 용도
- **CloudWatch**: 모니터링 및 알림 설정

## 5. 글로벌 확장을 위한 전략 🌍

WordPress 사이트를 전 세계적으로 확장하려면:

1. **CloudFront** 배포로 정적 콘텐츠 전송 가속화
2. **Aurora Global Database**로 여러 리전에 데이터 복제
3. **EFS 백업**을 여러 리전의 S3 버킷에 저장
4. **Route 53**의 지연 시간 기반 라우팅으로 사용자에게 가장 가까운 리전으로 트래픽 유도

## 6. 비용과 성능의 균형 맞추기 ⚖️

확장성과 안정성을 원하지만 비용도 중요하죠! 몇 가지 고려사항:

1. **EBS vs EFS**: EFS가 더 비싸지만 다중 인스턴스 환경에서는 필수적
2. **RDS vs Aurora**: Aurora가 약간 더 비싸지만 성능과 확장성이 대폭 향상
3. **Reserved Instances**: 예측 가능한 워크로드에 대해 예약 인스턴스로 비용 절감
4. **스팟 인스턴스**: 비프로덕션 환경의 비용 절감을 위해 고려 가능

## 7. 요약 📌

1. **데이터베이스 선택**:
    - 소규모 시작: RDS MySQL (다중 AZ)
    - 대규모 확장: Aurora MySQL (다중 AZ + 읽기 전용 복제본)
2. **파일 스토리지 선택**:
    - 단일 인스턴스: EBS (비용 효율적)
    - 다중 인스턴스: EFS (필수적, 공유 스토리지)
3. **확장성 vs 비용**:
    - EFS는 EBS보다 비싸지만 다중 인스턴스 환경에서는 필수
    - Aurora는 RDS보다 비싸지만 성능과 확장성이 뛰어남
    - 각 선택에는 장단점이 있으며, 사용 사례에 맞게 결정해야 함
